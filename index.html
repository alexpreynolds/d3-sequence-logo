<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="js/d3.v4.min.js"></script>
  <script src="js/sequence_logo.js"></script>
</head>
<body>
  <div id="button" class="center">
    <button id="randseq">Generate random sequences</button> 
    <button id="mememotif">Generate MEME motif</button>
  </div>
  <div id="main" class="center">
  </div>
</body>
<script> 
  /**
  * Sequence data. 
  *
  * In a real application, this would not be hardcoded, 
  * but rather a function would be created to accept and parse 
  * user input into this format (or another simple format that d3 
  * understands). 
  *
  * That function would also likely be the one to call 
  * validateData (see below), whereas in the current implementation 
  * we have the entryPoint call it directly.
  */
  
  const sequenceData = ['AGATCGACCCT',
    'GGAACGACGCT',
    'GGATCGACCCT',
    'CGATAGACGCT',
    'CGATAGACGCT',
    'GGATCGACCCT'];
    
  const memeMotifSampleData = [
`MEME version 4

ALPHABET= ACGT

strands: + -

Background letter frequencies
A 0.303 C 0.183 G 0.209 T 0.306 

MOTIF lexA
letter-probability matrix: alength= 4 w= 18 nsites= 14 E= 3.2e-035 
 0.214286  0.000000  0.000000  0.785714 
 0.857143  0.000000  0.071429  0.071429 
 0.000000  1.000000  0.000000  0.000000 
 0.000000  0.000000  0.000000  1.000000 
 0.000000  0.000000  1.000000  0.000000 
 0.000000  0.000000  0.000000  1.000000 
 0.857143  0.000000  0.071429  0.071429 
 0.000000  0.071429  0.000000  0.928571 
 0.857143  0.000000  0.071429  0.071429 
 0.142857  0.000000  0.000000  0.857143 
 0.571429  0.071429  0.214286  0.142857 
 0.285714  0.285714  0.000000  0.428571 
 1.000000  0.000000  0.000000  0.000000 
 0.285714  0.214286  0.000000  0.500000 
 0.428571  0.500000  0.000000  0.071429 
 0.000000  1.000000  0.000000  0.000000 
 1.000000  0.000000  0.000000  0.000000 
 0.000000  0.000000  0.785714  0.214286
`,
`MEME version 4

ALPHABET= ACGT

strands: + -

Background letter frequencies
A 0.303 C 0.183 G 0.209 T 0.306 

MOTIF crp
letter-probability matrix: alength= 4 w= 19 nsites= 17 E= 4.1e-009 
 0.000000  0.176471  0.000000  0.823529 
 0.000000  0.058824  0.647059  0.294118 
 0.000000  0.058824  0.000000  0.941176 
 0.176471  0.000000  0.764706  0.058824 
 0.823529  0.058824  0.000000  0.117647 
 0.294118  0.176471  0.176471  0.352941 
 0.294118  0.352941  0.235294  0.117647 
 0.117647  0.235294  0.352941  0.294118 
 0.529412  0.000000  0.176471  0.294118 
 0.058824  0.235294  0.588235  0.117647 
 0.176471  0.235294  0.294118  0.294118 
 0.000000  0.058824  0.117647  0.823529 
 0.058824  0.882353  0.000000  0.058824 
 0.764706  0.000000  0.176471  0.058824 
 0.058824  0.882353  0.000000  0.058824 
 0.823529  0.058824  0.058824  0.058824 
 0.176471  0.411765  0.058824  0.352941 
 0.411765  0.000000  0.000000  0.588235 
 0.352941  0.058824  0.000000  0.588235 
`,
`MEME version 4.4

ALPHABET= ACGT

strands: + -

Background letter frequencies (from uniform background):
A 0.25000 C 0.25000 G 0.25000 T 0.25000 

MOTIF V_CMYB_01 c-Myb

letter-probability matrix: alength= 4 w= 18 nsites= 43 E= 0
  0.037037        0.444444        0.222222        0.296296
  0.222222        0.555556        0.185185        0.037037
  0.200000        0.333333        0.300000        0.166667
  0.421053        0.131579        0.368421        0.078947
  0.432432        0.297297        0.216216        0.054054
  0.183673        0.326531        0.163265        0.326531
  0.156863        0.078431        0.666667        0.098039
  0.392157        0.019608        0.490196        0.098039
  0.066667        0.816667        0.033333        0.083333
  0.300000        0.300000        0.333333        0.066667
  0.000000        0.000000        1.000000        0.000000
  0.000000        0.000000        0.000000        1.000000
  0.000000        0.000000        0.000000        1.000000
  0.183333        0.016667        0.783333        0.016667
  0.157895        0.157895        0.552632        0.131579
  0.029412        0.205882        0.441176        0.323529
  0.100000        0.100000        0.600000        0.200000
  0.076923        0.000000        0.846154        0.076923
`];

  /*
   * These bounds are prototype-specific and are meant to preserve
   * visual appearance. 
   *
   * In a real setting, it would need to be carefully considered 
   * what they should be (based on usage expectations, etc) since 
   * we would not want the user to be able to input unbounded data 
   * without altering behavior somehow (if the length were 
   * compressed to fit in a viewport, each individual position would 
   * be reduced to 0 width)
   */
 
  const seqLenBounds = [5, 25];
  const seqNumBounds = [1, 10];

  const memeObj = parseMEMEMotif(randomMemeMotif(memeMotifSampleData))
  entryPointByMEMEMotif(memeObj);

  document.getElementById('randseq').onclick = refreshRandomSVG.bind(null, seqLenBounds, seqNumBounds);
  document.getElementById('mememotif').onclick = refreshMEMEMotifSVG.bind(null, memeMotifSampleData);

</script>
